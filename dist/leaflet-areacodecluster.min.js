!function(){"use strict";var e;(e=window.L).AreaCodeCluster=e.FeatureGroup.extend({options:{pad:0},initialize:function(t,a,r){var o=this;this._areaCodeMap={},this._areaCodeList=[];var n=function(e,t){var a={markers:[],points:[],children:[]};e.label&&(a.label=e.label),e.areaCode&&(a.areaCode=e.areaCode),e.maxZoom&&(a.maxZoom=e.maxZoom),t&&(t.children.push(a),a.parent=t),o._areaCodeList.push(a),a.areaCode&&(o._areaCodeMap[a.areaCode]=a),e.children&&e.children.forEach((function(e){n(e,a)}))};n(t,null),e.Util.setOptions(this,r),this._markers=[],a&&a.forEach((function(e){o.addMarker(e)})),e.FeatureGroup.prototype.initialize.call(this,[])},addMarker:function(e){var t=e.options.areacode;this._areaCodeMap[t]?this._areaCodeMap[t].markers.push(e):console.error(t+" not found",e)},onAdd:function(t){this._areaCodeList.forEach((function(e){e.points=[]})),this._areaCodeList.filter((function(e){return e.markers.length>0})).forEach((function(e){for(var t=e.markers.map((function(e){return e.getLatLng()})),a=e;a;)a.points=a.points.concat(t),a=a.parent})),this._areaCodeList.forEach((function(t){t.count=t.points.length,t.count>0&&(t.point=e.latLng(0,0),t.points.forEach((function(e){t.point.lat+=e.lat/t.count,t.point.lng+=e.lng/t.count})))})),this.refresh()},getEvents:function(){return{moveend:this.update,zoomend:this.refresh,viewreset:this.refresh,zoomlevelschange:this.refresh}},update:function(){var e=this;if(this._map){var t=this._map.getBounds().pad(this.options.pad);this._markers.forEach((function(a){t.contains(a.getLatLng())?e.hasLayer(a)||e.addLayer(a):e.hasLayer(a)&&e.removeLayer(a)}))}},refresh:function(){if(this._map){var t=this._map.getZoom(),a=[],r=function(o){if(o.maxZoom<t)a=a.concat(o.markers),o.children&&o.children.forEach(r);else{if(0===o.count)return;var n="marker-cluster-";o.count<10?n+="small":o.count<100?n+="medium":n+="large";var i=e.marker(o.point,{icon:e.divIcon({html:"<div><span>"+o.count+"</span></div>",className:"marker-cluster "+n,iconSize:e.point(40,40)})});o.count>1&&(i.rectangle=e.rectangle(o.points),i.on("mouseover",(function(){this._map.addLayer(i.rectangle)})),i.on("mouseout remove",(function(){this._map.removeLayer(i.rectangle)}))),i.on("click",(function(){this._map.setView(i.getLatLng(),o.maxZoom+1)}));var s=(o.id||"")+(o.label||"");s.length>0&&i.bindTooltip(s),a.push(i)}};this._areaCodeList.filter((function(e){return void 0===e.parent})).forEach(r),this.clearLayers(),this._markers=a,this.update()}}}),e.areaCodeCluster=function(t,a,r){return new e.AreaCodeCluster(t,a,r)}}();
