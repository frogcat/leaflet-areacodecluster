!function(){"use strict";L.AreaCodeCluster=L.FeatureGroup.extend({options:{clusterMarkerFactory:function(e,t){var o=e.length,r=e.map((function(e){return e.getLatLng()})),n=r.reduce((function(e,t){return L.latLng(e.lat+t.lat/o,e.lng+t.lng/o)}),L.latLng(0,0)),a=L.latLngBounds(r),s=["area-code-cluster"];o<10?s.push("area-code-cluster-small"):o<100?s.push("area-code-cluster-medium"):s.push("area-code-cluster-large");var i=L.marker(n,{icon:L.divIcon({html:"<span>"+o+"</span>",className:s.join(" "),iconSize:L.point(40,40)})});return t.length>0&&i.bindTooltip(t),a.isValid()&&(i._rectangle=L.rectangle(a),i.on("mouseover",(function(){this._map.addLayer(this._rectangle)})),i.on("mouseout remove",(function(){this._map.removeLayer(this._rectangle)}))),a.isValid()?i.on("click",(function(){var e=this._map._getBoundsCenterZoom(a).zoom,t=this._map.getZoom();e<=t?this._map.setView(this.getLatLng(),t+1):this._map.fitBounds(a)})):i.on("click",(function(){this._map.setView(this.getLatLng(),this._map.getZoom()+1)})),i},areaCodeModifier:function(e,t){return e<=1?"":e<=6?t:null}},initialize:function(e,t){var o=this;L.Util.setOptions(this,t),this._sourceCluster={},this._markersForCurrentZoom=[],e&&e.forEach((function(e){o.addMarker(e)})),L.FeatureGroup.prototype.initialize.call(this,[])},addMarker:function(e){var t=e.options.areaCode,o=this._sourceCluster[t]||(this._sourceCluster[t]=[]);-1===o.indexOf(e)&&o.push(e)},removeMarker:function(e){var t=this;Object.keys(this._sourceCluster).forEach((function(o){t._sourceCluster[o]=t._sourceCluster[o].filter((function(t){return t!==e}))}))},onAdd:function(e){this._onZoomEnd()},getEvents:function(){return{moveend:this._onMoveEnd,zoomend:this._onZoomEnd,viewreset:this._onZoomEnd,zoomlevelschange:this._onZoomEnd}},_onMoveEnd:function(){var e=this;if(this._map){var t=this._map.getBounds();this._markersForCurrentZoom.forEach((function(o){t.contains(o.getLatLng())?e.hasLayer(o)||e.addLayer(o):e.hasLayer(o)&&e.removeLayer(o)}))}},_onZoomEnd:function(){var e=this;if(this._map){var t=this._map.getZoom();this.clearLayers(),this._markersForCurrentZoom=[];var o={};Object.keys(this._sourceCluster).forEach((function(r){var n=e._sourceCluster[r],a=e.options.areaCodeModifier(t,r);if(null===a||!1===a||void 0===a)Array.prototype.push.apply(e._markersForCurrentZoom,n);else{var s=o[a]||(o[a]=[]);Array.prototype.push.apply(s,n)}})),Object.keys(o).forEach((function(t){var r=o[t];e._markersForCurrentZoom.push(e.options.clusterMarkerFactory(r,t))})),this._onMoveEnd()}}}),L.areaCodeCluster=function(e,t){return new L.AreaCodeCluster(e,t)}}();
