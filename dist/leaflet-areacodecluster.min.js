!function(){"use strict";L.AreaCodeCluster=L.LayerGroup.extend({options:{clusterMarkerFactory:function(r,e){var o=r.length,t=r.map((function(r){return r.getLatLng()})),a=t.reduce((function(r,e){return L.latLng(r.lat+e.lat/o,r.lng+e.lng/o)}),L.latLng(0,0)),n=L.latLngBounds(t),i=["area-code-cluster"];o<10?i.push("area-code-cluster-small"):o<100?i.push("area-code-cluster-medium"):i.push("area-code-cluster-large");var s=L.marker(a,{icon:L.divIcon({html:"<span>"+o+"</span>",className:i.join(" "),iconSize:L.point(40,40)})});return e.length>0&&s.bindTooltip(e),n.isValid()&&(s._rectangle=L.rectangle(n),s.on("mouseover",(function(){this._map.addLayer(this._rectangle)})),s.on("mouseout remove",(function(){this._map.removeLayer(this._rectangle)}))),n.isValid()?s.on("click",(function(){var r=this._map._getBoundsCenterZoom(n).zoom,e=this._map.getZoom();r<=e?this._map.setView(this.getLatLng(),e+1):this._map.fitBounds(n)})):s.on("click",(function(){this._map.setView(this.getLatLng(),this._map.getZoom()+1)})),s},areaCodeModifier:function(r,e){return r<=1?"":r<=6?e:null}},initialize:function(r,e){this._markers={},this._markersForCurrentZoom=[],L.LayerGroup.prototype.initialize.call(this,r,e)},addLayer:function(r){var e=r.options.areaCode;if(e){var o=this._markers[e]||(this._markers[e]=[]);return-1!==o.indexOf(r)||(o.push(r),this._map&&this._onZoomEnd()),this}return L.LayerGroup.prototype.addLayer.call(this,r)},removeLayer:function(r){var e=this;return Object.values(this._markers).forEach((function(o){var t=o.indexOf(r);-1!==t&&(o.splice(t,1),e._onZoomEnd())})),L.LayerGroup.prototype.removeLayer.call(this,r)},clearLayers:function(){return this._markers={},this._markersForCurrentZoom=[],L.LayerGroup.prototype.clearLayers.call(this)},onAdd:function(r){L.LayerGroup.prototype.onAdd.call(this,r),this._onZoomEnd()},getEvents:function(){return{moveend:this._onMoveEnd,zoomend:this._onZoomEnd,viewreset:this._onZoomEnd,zoomlevelschange:this._onZoomEnd}},_onMoveEnd:function(){var r=this;if(this._map){var e=this._map.getBounds();this._markersForCurrentZoom.forEach((function(o){e.contains(o.getLatLng())?r.hasLayer(o)||L.LayerGroup.prototype.addLayer.call(r,o):r.hasLayer(o)&&L.LayerGroup.prototype.removeLayer.call(r,o)}))}},_onZoomEnd:function(){var r=this;if(this._map){for(var e=this._map.getZoom();this._markersForCurrentZoom.length>0;)L.LayerGroup.prototype.removeLayer.call(this,this._markersForCurrentZoom.pop());var o={};Object.keys(this._markers).forEach((function(t){var a=r._markers[t],n=r.options.areaCodeModifier(e,t);if(null===n||!1===n||void 0===n)Array.prototype.push.apply(r._markersForCurrentZoom,a);else{var i=o[n]||(o[n]=[]);Array.prototype.push.apply(i,a)}})),Object.keys(o).forEach((function(e){var t=o[e],a=r.options.clusterMarkerFactory(t,e);r._markersForCurrentZoom.push(a)})),this._onMoveEnd()}}}),L.areaCodeCluster=function(r,e){return new L.AreaCodeCluster(r,e)}}();
