!function(){"use strict";L.AreaCodeCluster=L.FeatureGroup.extend({options:{clusterMarkerFactory:function(e,r){var t=e.length,o=e.map((function(e){return e.getLatLng()})),a=o.reduce((function(e,r){return L.latLng(e.lat+r.lat/t,e.lng+r.lng/t)}),L.latLng(0,0)),n=L.latLngBounds(o),i=["area-code-cluster"];t<10?i.push("area-code-cluster-small"):t<100?i.push("area-code-cluster-medium"):i.push("area-code-cluster-large");var s=L.marker(a,{icon:L.divIcon({html:"<span>"+t+"</span>",className:i.join(" "),iconSize:L.point(40,40)})});return r.length>0&&s.bindTooltip(r),n.isValid()&&(s._rectangle=L.rectangle(n),s.on("mouseover",(function(){this._map.addLayer(this._rectangle)})),s.on("mouseout remove",(function(){this._map.removeLayer(this._rectangle)}))),n.isValid()?s.on("click",(function(){var e=this._map._getBoundsCenterZoom(n).zoom,r=this._map.getZoom();e<=r?this._map.setView(this.getLatLng(),r+1):this._map.fitBounds(n)})):s.on("click",(function(){this._map.setView(this.getLatLng(),this._map.getZoom()+1)})),s},areaCodeModifier:function(e,r){return e<=1?"":e<=6?r:null}},initialize:function(e,r){this._markers={},this._markersForCurrentZoom=[],L.FeatureGroup.prototype.initialize.call(this,e,r)},addLayer:function(e){var r=e.options.areaCode;if(r){var t=this._markers[r]||(this._markers[r]=[]);return-1!==t.indexOf(e)?this:(t.push(e),this._map&&this._onZoomEnd(),this.fire("layeradd",{layer:e}))}return L.FeatureGroup.prototype.addLayer.call(this,e)},removeLayer:function(e){var r=e.options.areaCode;if(r){var t=this._markers[r];return t&&t.find((function(r){return r===e}))?(this._markers[r]=t.filter((function(r){return r!==e})),this._map&&this._onZoomEnd(),this.fire("layerremove",{layer:e})):this}return L.FeatureGroup.prototype.removeLayer.call(this,e)},clearLayers:function(){return this._markers={},this._markersForCurrentZoom=[],L.FeatureGroup.prototype.clearLayers.call(this)},onAdd:function(e){L.FeatureGroup.prototype.onAdd.call(this,e),this._onZoomEnd()},getEvents:function(){return{moveend:this._onMoveEnd,zoomend:this._onZoomEnd,viewreset:this._onZoomEnd,zoomlevelschange:this._onZoomEnd}},_onMoveEnd:function(){var e=this;if(this._map){var r=this._map.getBounds();this._markersForCurrentZoom.forEach((function(t){r.contains(t.getLatLng())?e.hasLayer(t)||L.FeatureGroup.prototype.addLayer.call(e,t):e.hasLayer(t)&&L.FeatureGroup.prototype.removeLayer.call(e,t)}))}},_onZoomEnd:function(){var e=this;if(this._map){for(var r=this._map.getZoom();this._markersForCurrentZoom.length>0;)L.FeatureGroup.prototype.removeLayer.call(this,this._markersForCurrentZoom.pop());var t={};Object.keys(this._markers).forEach((function(o){var a=e._markers[o],n=e.options.areaCodeModifier(r,o);if(null===n||!1===n||void 0===n)Array.prototype.push.apply(e._markersForCurrentZoom,a);else{var i=t[n]||(t[n]=[]);Array.prototype.push.apply(i,a)}})),Object.keys(t).forEach((function(r){var o=t[r],a=e.options.clusterMarkerFactory(o,r);e._markersForCurrentZoom.push(a)})),this._onMoveEnd()}}}),L.areaCodeCluster=function(e,r){return new L.AreaCodeCluster(e,r)}}();
