!function(){"use strict";L.AreaCodeCluster=L.FeatureGroup.extend({options:{showCoverageOnHover:!0,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0,iconCreateFunction:null},initialize:function(e,t,r){var n=this;L.Util.setOptions(this,r),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._resolver=e,this._areacodeCluster={},this._markers=[],t&&t.forEach((function(e){n.addMarker(e)})),L.FeatureGroup.prototype.initialize.call(this,[])},addMarker:function(e){var t=e.options.areacode;this._resolver.isValid(t)?(void 0===this._areacodeCluster[t]&&(this._areacodeCluster[t]=[]),-1===this._areacodeCluster[t].indexOf(e)&&this._areacodeCluster[t].push(e)):console.error("invalid areacode",t)},onAdd:function(e){this.refresh()},getEvents:function(){return{moveend:this.update,zoomend:this.refresh,viewreset:this.refresh,zoomlevelschange:this.refresh}},update:function(){var e=this;if(this._map)if(this.options.removeOutsideVisibleBounds){var t=this._map.getBounds();this._markers.forEach((function(r){t.contains(r.getLatLng())?e.hasLayer(r)||e.addLayer(r):e.hasLayer(r)&&e.removeLayer(r)}))}else this._markers.forEach((function(t){e.hasLayer(t)||e.addLayer(t)}))},refresh:function(){var e=this;if(this._map){var t=this._map.getZoom();this.clearLayers(),this._markers=[];var r={};Object.keys(this._areacodeCluster).forEach((function(n){var o=e._areacodeCluster[n],i=e._resolver.resolve(t,n);i&&0!==i.length?(void 0===r[i]&&(r[i]=[]),Array.prototype.push.apply(r[i],o)):Array.prototype.push.apply(e._markers,o)})),Object.values(r).forEach((function(t){var r=e._createMarker(t);e._markers.push(r)})),this.update()}},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),r=" marker-cluster-";return r+=t<10?"small":t<100?"medium":"large",L.divIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+r,iconSize:new L.Point(40,40)})},_createMarker:function(e){var t=e.length,r=e.map((function(e){return e.getLatLng()})),n=r.reduce((function(e,r){return L.latLng(e.lat+r.lat/t,e.lng+r.lng/t)}),L.latLng(0,0)),o=L.latLngBounds(r),i=L.marker(n,{icon:this.options.iconCreateFunction({getChildCount:function(){return e.length},getAllChildMarkers:function(){return e}})});return this.options.showCoverageOnHover&&o.isValid()&&(i._rectangle=L.rectangle(o),i.on("mouseover",(function(){this._map.addLayer(this._rectangle)})),i.on("mouseout remove",(function(){this._map.removeLayer(this._rectangle)}))),this.options.zoomToBoundsOnClick&&(o.isValid()?i.on("click",(function(){var e=this._map._getBoundsCenterZoom(o).zoom,t=this._map.getZoom();e<=t?this._map.setView(this.getLatLng(),t+1):this._map.fitBounds(o)})):i.on("click",(function(){this._map.setView(this.getLatLng(),this._map.getZoom()+1)}))),i}});var e={isValid:function(e){return!!e.match(/^[0-9]{5}$/)},resolve:function(e,t){return e<=4?"00000":e<=8?t.replace(/[0-9]{3}$/,"000"):e<=12?t:""}},t={isValid:function(e){return!!e.match(/^[A-Z]{2}$/)},resolve:function(e,t){return e<=1?"00":e<=6?t:""}};L.areaCodeCluster=function(e,t,r){return new L.AreaCodeCluster(e,t,r)},L.areaCodeCluster.world=function(e,r){return new L.AreaCodeCluster(t,e,r)},L.areaCodeCluster.jp=function(t,r){return new L.AreaCodeCluster(e,t,r)}}();
