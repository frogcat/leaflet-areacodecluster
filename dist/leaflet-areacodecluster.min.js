!function(){"use strict";var e;(e=window.L).AreaCodeCluster=e.FeatureGroup.extend({options:{showCoverageOnHover:!0,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0,iconCreateFunction:function(o){var t=o.getChildCount(),r=" marker-cluster-";return r+=t<10?"small":t<100?"medium":"large",e.divIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+r,iconSize:e.point(40,40)})}},initialize:function(o,t,r){var a=this;this._areaCodeMap={},this._areaCodeList=[];var n=function(e,o){var t={markers:[],points:[],children:[]};e.label&&(t.label=e.label),e.areaCode&&(t.areaCode=e.areaCode),e.maxZoom&&(t.maxZoom=e.maxZoom),o&&(o.children.push(t),t.parent=o),a._areaCodeList.push(t),t.areaCode&&(Array.isArray(t.areaCode)?t.areaCode:[t.areaCode]).forEach((function(e){a._areaCodeMap[e]=t})),e.children&&e.children.forEach((function(e){n(e,t)}))};n(o,null),e.Util.setOptions(this,r),this._markers=[],t&&t.forEach((function(e){a.addMarker(e)})),e.FeatureGroup.prototype.initialize.call(this,[])},addMarker:function(e){var o=e.options.areacode;this._areaCodeMap[o]?this._areaCodeMap[o].markers.push(e):console.error(o+" not found",e)},onAdd:function(o){this._areaCodeList.forEach((function(e){e.points=[]})),this._areaCodeList.filter((function(e){return e.markers.length>0})).forEach((function(e){for(var o=e.markers.map((function(e){return e.getLatLng()})),t=e;t;)t.points=t.points.concat(o),t=t.parent})),this._areaCodeList.forEach((function(o){o.count=o.points.length,o.count>0&&(o.point=e.latLng(0,0),o.points.forEach((function(e){o.point.lat+=e.lat/o.count,o.point.lng+=e.lng/o.count})))})),this.refresh()},getEvents:function(){return{moveend:this.update,zoomend:this.refresh,viewreset:this.refresh,zoomlevelschange:this.refresh}},update:function(){var e=this;if(this._map)if(this.options.removeOutsideVisibleBounds){var o=this._map.getBounds();this._markers.forEach((function(t){o.contains(t.getLatLng())?e.hasLayer(t)||e.addLayer(t):e.hasLayer(t)&&e.removeLayer(t)}))}else this._markers.forEach((function(o){e.hasLayer(o)||e.addLayer(o)}))},refresh:function(){var o=this;if(this._map){var t=this._map.getZoom(),r=[],a=function(n){if(n.maxZoom<t)r=r.concat(n.markers),n.children&&n.children.forEach(a);else{if(0===n.count)return;var i=e.marker(n.point,{icon:o.options.iconCreateFunction({getChildCount:function(){return n.count}})});o.options.showCoverageOnHover&&n.count>1&&(i.rectangle=e.rectangle(n.points),i.on("mouseover",(function(){this._map.addLayer(i.rectangle)})),i.on("mouseout remove",(function(){this._map.removeLayer(i.rectangle)}))),o.options.zoomToBoundsOnClick&&i.on("click",(function(){this._map.setView(i.getLatLng(),n.maxZoom+1)}));var s=(n.id||"")+(n.label||"");s.length>0&&i.bindTooltip(s),r.push(i)}};this._areaCodeList.filter((function(e){return void 0===e.parent})).forEach(a),this.clearLayers(),this._markers=r,this.update()}}}),e.areaCodeCluster=function(o,t,r){return new e.AreaCodeCluster(o,t,r)}}();
